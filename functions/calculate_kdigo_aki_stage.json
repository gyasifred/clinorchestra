{
  "name": "calculate_kdigo_aki_stage",
  "description": "Calculate KDIGO AKI (Acute Kidney Injury) stage based on creatinine changes or urine output. Stages: 0 (no AKI), 1 (mild), 2 (moderate), 3 (severe).",
  "parameters": {
    "baseline_creatinine": {
      "type": "float",
      "description": "Baseline creatinine in mg/dL",
      "required": false
    },
    "current_creatinine": {
      "type": "float",
      "description": "Current creatinine in mg/dL",
      "required": false
    },
    "urine_output_6h": {
      "type": "float",
      "description": "Urine output over 6 hours in mL",
      "required": false
    },
    "urine_output_12h": {
      "type": "float",
      "description": "Urine output over 12 hours in mL",
      "required": false
    },
    "urine_output_24h": {
      "type": "float",
      "description": "Urine output over 24 hours in mL",
      "required": false
    },
    "weight_kg": {
      "type": "float",
      "description": "Patient weight in kg (for urine output calculation)",
      "required": false
    }
  },
  "returns": {
    "type": "dict",
    "description": "Dictionary with stage (0-3), severity, and criteria_met"
  },
  "code": "\ndef calculate_kdigo_aki_stage(baseline_creatinine=None, current_creatinine=None, urine_output_6h=None, urine_output_12h=None, urine_output_24h=None, weight_kg=None):\n    stage = 0\n    criteria_met = []\n    \n    # Creatinine criteria\n    if baseline_creatinine is not None and current_creatinine is not None:\n        cr_increase = current_creatinine - baseline_creatinine\n        cr_ratio = current_creatinine / baseline_creatinine\n        \n        if cr_increase >= 0.3 or cr_ratio >= 1.5:\n            stage = max(stage, 1)\n            criteria_met.append('Cr increase ≥0.3 mg/dL or 1.5x baseline')\n        \n        if cr_ratio >= 2.0:\n            stage = max(stage, 2)\n            criteria_met.append('Cr increase 2x baseline')\n        \n        if cr_ratio >= 3.0 or current_creatinine >= 4.0:\n            stage = max(stage, 3)\n            criteria_met.append('Cr increase 3x baseline or ≥4.0 mg/dL')\n    \n    # Urine output criteria (if weight provided)\n    if weight_kg is not None:\n        if urine_output_6h is not None:\n            uo_6h_rate = urine_output_6h / (weight_kg * 6)  # mL/kg/h\n            if uo_6h_rate < 0.5:\n                stage = max(stage, 1)\n                criteria_met.append('UO <0.5 mL/kg/h for 6h')\n            if uo_6h_rate < 0.3:\n                stage = max(stage, 3)\n                criteria_met.append('UO <0.3 mL/kg/h for 6h')\n        \n        if urine_output_12h is not None:\n            uo_12h_rate = urine_output_12h / (weight_kg * 12)\n            if uo_12h_rate < 0.5:\n                stage = max(stage, 2)\n                criteria_met.append('UO <0.5 mL/kg/h for 12h')\n        \n        if urine_output_24h is not None:\n            uo_24h_rate = urine_output_24h / (weight_kg * 24)\n            if uo_24h_rate < 0.3 or urine_output_24h < 500:\n                stage = max(stage, 3)\n                criteria_met.append('UO <0.3 mL/kg/h for 24h or anuria')\n    \n    severity_map = {\n        0: 'No AKI',\n        1: 'Mild AKI (Stage 1)',\n        2: 'Moderate AKI (Stage 2)',\n        3: 'Severe AKI (Stage 3)'\n    }\n    \n    return {\n        'stage': stage,\n        'severity': severity_map.get(stage, 'Unknown'),\n        'criteria_met': criteria_met\n    }\n"
}
